<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cart</title>
    <link rel="stylesheet" href="shoppe.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css" integrity="sha384-xOolHFLEh07PJGoPkLv1IbcEPTNtaed2xpHsD9ESMhqIYd0nLMwNLD69Npy4HI+N" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
</head>
<body>
    <header>
        <div class="container">
            <a href="Home.html">
                <img src="https://i.ibb.co/tH59cgv/logo.png" alt="logo">
            </a>
            <nav> 
                <div class="user-dropdown" style="position: relative;">
                  <div class="nav-hover">
                    <img src="logo.png" alt="">
                    <i class="fa fa-shopping-cart"></i>
                    <a>GeForce Official Store</a>
                  </div>

                  <div class="dropdown-menu">
                    <button class="dropdown-item" type="button">Trang chủ</button>
                    <button class="dropdown-item" type="button">Thời trang</button>
                    <button class="dropdown-item" type="button">Sách</button>
                  </div>
                </div>
                <div class="search-box">
                  <form class="search-box" >
                    <input type="text" id="searchInput" />
                    <button id="searchButton">Tìm kiếm</button>                      
                  </form>
                </div>
          </nav>
        </div>
    </header>

    <main>
        <h1 class="cart">Giỏ hàng của bạn</h1>
        <div class="cart-item" id="cart-item">
           
        </div>
       <!-- Tổng tiền và nút thanh toán -->
    <div class="pay">
      <h2>Tổng tiền:</h2>
      <p class="total-price" id="total-price"></p>
      <button class="checkout">Thanh toán</button>
       <!-- Progress Bar -->
      <div class="progress" style="display: none;">
      <div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" style="width: 0%"
        aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>
    </div>
    </div>
   
    </main>

    <footer>
        <div class="container">
            <img src="https://i.ibb.co/tH59cgv/logo.png" alt="logo">
            <nav>
                <p>Địa chỉ: Đường ABC, Quận XYZ, Thành phố ABC</p>
                <p>Email: contact@example.com</p>
                <p>Điện thoại: 0123 456 789</p>
            </nav>
        </div>    
    </footer>
    <!-- Script -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <script>
        // $(document).ready(function(){
        //     var progressBar=$("#progress-bar");
        //     var progressValue=0;
        //     var interval=setInterval(function(){
        //         progressValue +=10;
        //         progressBar.css("width", progressValue + "%").attr("aria-valuenow", progressValue);
        //         if (progressValue>=100){
        //             clearInterval(interval);}}, 1000);
        //         });


        $(document).ready(function () {
      // Xử lý khi nút thanh toán được nhấn
      $(".checkout").click(function () {
        // Ẩn nút thanh toán
        var totalPriceElement = document.getElementById("total-price").textContent;
        if (account && parseFloat(account.fund) > parseFloat(totalPriceElement.replace("₫", "").trim())) {
          $(this).hide();
          // Hiển thị Progress Bar
          $(".progress").show();

          // Khởi tạo giá trị ban đầu của Progress Bar
          let progressValue = 0;

          // Sử dụng setInterval để tăng giá trị Progress Bar mỗi 1 giây
          const progressInterval = setInterval(function () {
            if (progressValue < 100) {
              progressValue += 10; // Tăng 10% sau mỗi lần
              $(".progress-bar").css("width", progressValue + "%");
              $(".progress-bar").attr("aria-valuenow", progressValue);
            } else {
              // Đạt 100%, hiển thị thông báo và ẩn Progress Bar cũng như hiện lại button và trả về 0%
              clearInterval(progressInterval);

              account.fund -= parseFloat(totalPriceElement.replace("₫", "").trim());
              account.orderNumber += 1;
              // Cập nhật thông tin tài khoản trong storage
              localStorage.setItem("accounts", JSON.stringify(accounts));
              localStorage.removeItem("cart");
              displayCartItems();

              alert("Thanh toán thành công!");
              $(".progress").hide();
              $(".checkout").show();
              $(".progress-bar").css("width", "0%");
            }
          }, 1000); // Mỗi 1 giây
        }
        else
          alert("Số dư không đủ !");
      });
    });
$(document).ready(function() {
    $('#searchButton').click(function() {
        var searchValue = $('#searchInput').val();
        alert('Giá trị đã nhập: ' + searchValue);
    });
    });

    // Dropdown
    $('.user-dropdown').hover(
    function(){
        $(this).addClass('active');
        $('.dropdown-menu', this).addClass('show');
    },
    function(){
        $(this).removeClass('active');
        $('.dropdown-menu', this).removeClass('show');
    }
    );
    </script>
    <script src="cartData.js"></script>
    <script src="loadAccount.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-Fy6S3B9q64WdZWQUiU+q4/2Lc9npb8tCaSX9FK7E8HnRr0Jz8D6OP9dO5Vg3Q9ct" crossorigin="anonymous"></script>
</body>
</html>